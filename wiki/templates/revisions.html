{% extends 'base.html' %}

{% load markup %}
{% block content %}
<h2>Revision History for /{{name}}</h2>
{% if current_revision %}
<div class='revision_history'>
    <h3>Current revision by {{current_revision.user}} on {{current_revision.date}}</h3>
    <p><strong>{{current_revision.notes}}</strong></p>
    <div>
        <div class='revision_diff'>
            <p><strong>Changes (diff)</strong></p>
            {{current_revision.diff|markdown}}
        </div>
        <div class='revision_after'>
            <p><strong>current content</strong></p>
            {{current_revision.revised_text|markdown}}
        </div>
    </div>
</div>
{% if revision_history %}
{% for revision in revision_history %}
<div class='revision_history'>
    <h3>past revision by {{revision.user}} on {{revision.date}}</h3>
    <p><strong>{{revision.notes}}</strong></p>
    <div>
        <div class='revision_diff'>
            <p><strong>Changes (diff)</strong></p>
            {{revision.diff|markdown}}
        </div>
        <div class='revision_after'>
            <p><strong>post-revision content</strong></p>
            {{revision.revised_text|markdown}}
            <form action="/wiki/{{slug}}/select_revision/" method='post'>{% csrf_token %}
                <input type='text' name='id' style='display:none' value='{{revision.id}}'/>
                <input type='submit' value='publish this revision'/>
            </form>
        </div>
    </div>
</div>
{% endfor %}
{% endif %}
{% else %}
<h3>No revision history for {{name}}</h3>
{% endif %}
{% endblock %}
